---
- name: mkdir -pv ~/dotfiles
  file: path=~/dotfiles state=directory

- name: ~/.profile
  template: src=profile.j2 dest={{ test_path }}/profile backup=yes
  tags:
    - bash

- name: ~/.shrc
  template: src=shrc.j2  dest={{ test_path }}/shrc backup=yes
  tags:
    - bash

- name: ~/.bashrc
  template: src=bashrc.j2  dest={{ test_path }}/bashrc backup=yes
  tags:
    - bash

- name: ~/.vimrc
  template: src=vimrc.j2 dest={{ test_path }}/vimrc backup=yes
  tags:
    - vim

- name: Check tmux verson
  command: tmux -V
  register: tmux_version
  tags:
    - v

- debug: var=tmux_version.stdout_lines
  tags:
    - v
- debug: var=tmux_version.stdout.strip()
  tags:
    - v
- debug: var=tmux_version.stdout.strip().split()[1]
  tags:
    - v
- name: Add as Fact for tmux version
  set_fact:
    version: "{{ tmux_version.stdout.strip().split()[1] }}"
  tags:
    - v
- debug: var=version
  tags:
    - v

- name: ~/.tmux.conf
  template: src=tmux.conf.j2 dest={{ test_path }}/tmux.conf backup=yes
  tags:
    - v

- name: ~/.pythonstartup
  copy: src=pythonstartup dest={{ test_path }}/pythonstartup
  tags:
    - python

- name: ~/dotfiles/create.links.sh
  copy: src=create.links.sh dest={{ test_path }}/create.links.sh
  tags:
    - script

#- name: ~/.bashrc
#  template: src=bashrc.j2 dest= backup=yes
#  when: dev | default(false) | bool
#  with_items:
#    - zh_fast_onsum
#    - zh_inst_onsum
#  #tags:
#  #  - dev
#
### XXX test NO BackUp task executed only specify option : -e "test=true"
#- name:  test config
#  template: src={{ item.src }} dest={{ item.dest }}
#  when: test | default(false) | bool
#  with_items:
#    - { src: zh.fast.onsum.cfg.j2, dest: /root/zh_fast_onsum.cfg }
#    - { src: zh.inst.onsum.cfg.j2, dest: /root/zh_inst_onsum.cfg }
